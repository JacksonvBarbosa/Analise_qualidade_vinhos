# An√°lise da Qualidade de Vinhos
**Portf√≥lio de Data Analytics | Jackson dos Santos Ventura**

## üìä Projeto: An√°lise Explorat√≥ria de Vinhos Importados para JACKWine

### Contexto do Projeto
A distribuidora JACKWine est√° expandindo seu cat√°logo atrav√©s da importa√ß√£o de vinhos portugueses. Como analista de dados da empresa, realizei uma an√°lise explorat√≥ria dos dados, identificando os fatores qu√≠micos que influenciam a qualidade dos produtos. Al√©m disso, desenvolvi modelos de machine learning para prever a pontua√ß√£o de qualidade dos vinhos, fornecendo insights estrat√©gicos para apoiar o processo de sele√ß√£o e importa√ß√£o.

### Objetivo
Identificar rela√ß√µes entre os componentes qu√≠micos e a qualidade dos vinhos portugueses, visando compreender os principais fatores que influenciam sua avalia√ß√£o e utilizar esses insights para apoiar decis√µes estrat√©gicas e o desenvolvimento de modelos preditivos com machine learning.

## üî¨ Metodologia

### 1. Aquisi√ß√£o e Prepara√ß√£o dos Dados
**Dataset:** winequality-red.csv (Fonte: UCI Machine Learning Repository)

**Ferramentas:** Python, Pandas, NumPy, Matplotlib, Seaborn

**Procedimentos:**
- Importa√ß√£o e inspe√ß√£o inicial do dataset
- Tratamento de valores duplicados e ausentes
- Ajuste de tipos de dados
- Cria√ß√£o de fun√ß√µes modulares para extra√ß√£o, transforma√ß√£o e armazenamento de dados no pacote `etl/`
- Implementa√ß√£o de tratamento de outliers e balanceamento de classes no pacote `features/`

### 2. An√°lise Explorat√≥ria de Dados (EDA)
- Visualiza√ß√£o e an√°lise de distribui√ß√µes de vari√°veis qu√≠micas
- Identifica√ß√£o de correla√ß√µes entre vari√°veis e qualidade do vinho
- Uso de gr√°ficos de dispers√£o, boxplots, histogramas e mapas de calor
- Cria√ß√£o do m√≥dulo `visualization/` para centralizar fun√ß√µes gr√°ficas reutiliz√°veis

### 3. Desenvolvimento de Modelos de Machine Learning
- Estrutura de c√≥digo organizada em pacotes reutiliz√°veis (`models/`) para classifica√ß√£o, regress√£o e clustering
- Implementa√ß√£o de pipelines (`pipeline_classification.py`, `pipeline_regression.py`, `pipeline_clustering.py`) para padronizar o fluxo de treino e avalia√ß√£o
- Utiliza√ß√£o do `model_factory.py` com lazy loading, permitindo carregar modelos sob demanda e melhorar a escalabilidade do projeto
- Aplica√ß√£o de t√©cnicas de otimiza√ß√£o de hiperpar√¢metros com RandomizedSearchCV
- Avalia√ß√£o de modelos utilizando m√©tricas como Acur√°cia, Precis√£o, Recall, F1-score e ROC AUC

### 4. Modulariza√ß√£o e Escalabilidade
- Estrutura do projeto planejada para reuso e manuten√ß√£o em diferentes datasets
- Separa√ß√£o de responsabilidades por pacotes:
  - `etl/` ‚Üí Fun√ß√µes de extra√ß√£o, transforma√ß√£o e armazenamento
  - `features/` ‚Üí Engenharia de vari√°veis e tratamento de dados
  - `models/` ‚Üí Treinamento, avalia√ß√£o e pipelines de ML
  - `visualization/` ‚Üí Gera√ß√£o de gr√°ficos e plots
- Suporte para inclus√£o de novos modelos no `model_factory.py` sem altera√ß√£o no restante do c√≥digo

### 5. Armazenamento e Versionamento de Modelos
- Modelos treinados salvos em `models_storage/` para reutiliza√ß√£o futura
- Uso de joblib para serializa√ß√£o
- Versionamento do c√≥digo via GitHub

## üìä An√°lise Explorat√≥ria e Pr√©-Processamento ‚Äî Qualidade de Vinhos

Este estudo tem como objetivo analisar o Wine Quality Dataset, obtido atrav√©s do Kaggle, e aplicar t√©cnicas de pr√©-processamento para preparar os dados para modelos de machine learning voltados √† previs√£o da qualidade de vinhos.

### 1. Entendimento Inicial dos Dados
O dataset foi analisado em sua forma bruta (raw data), contendo atributos f√≠sico-qu√≠micos e a nota de qualidade do vinho.

A partir das estat√≠sticas descritivas, identificamos:
- Baixa dispers√£o na maioria das vari√°veis, devido ao baixo desvio padr√£o
- Maior variabilidade no di√≥xido de enxofre (livre e total), com desvio padr√£o elevado ‚Äî podendo apresentar valores muito acima ou abaixo da m√©dia

Esse comportamento pode comprometer a capacidade de generaliza√ß√£o dos modelos, tornando necess√°ria a padroniza√ß√£o dos dados para equilibrar as escalas durante o treinamento e teste.

### 2. Dados Duplicados
Registros duplicados s√£o comuns neste tipo de an√°lise, pois amostras com propriedades f√≠sico-qu√≠micas semelhantes tendem a gerar notas de qualidade pr√≥ximas ou iguais. Por isso, neste caso, a duplicidade n√£o foi tratada como erro.

### 3. Distribui√ß√£o e Outliers
Os gr√°ficos de distribui√ß√£o e boxplots mostraram:
- Aus√™ncia de distribui√ß√£o normal em v√°rias vari√°veis
- Presen√ßa de outliers detectados pelo IQR e z-score

Optou-se por manter os outliers detectados pelo IQR, aplicando capping para limitar valores extremos. Essa decis√£o reduz a dispers√£o e melhora o desempenho de algoritmos sens√≠veis √† escala, como Logistic Regression e SVM.

### 4. Rela√ß√µes Entre Vari√°veis

#### 4.1 Acidez Vol√°til √ó Qualidade
Vinhos de alta qualidade tendem a ter menor acidez vol√°til, idealmente abaixo de 1,0 g/L. No entanto, a acidez n√£o atua isoladamente e deve ser analisada junto a outros fatores.

#### 4.2 Teor Alco√≥lico √ó Qualidade
Os dados indicam rela√ß√£o diretamente proporcional (r ‚âà 0,48). Apesar disso:
- Maior teor alco√≥lico n√£o garante melhor qualidade
- Para equil√≠brio no paladar, recomenda-se manter abaixo de 13%
- Pela legisla√ß√£o brasileira, o m√≠nimo para ser considerado vinho √© 7%

#### 4.3 Sulfitos e √Åcido C√≠trico √ó Qualidade
- **Sulfito:** manter abaixo de 1,0 g/L para priorizar processos mais naturais
- **√Åcido c√≠trico:** manter abaixo de 0,5 g/L
- pH baixo contribui para maior longevidade do vinho

#### 4.4 Acidez Vol√°til √ó Teor Alco√≥lico
N√£o h√° padr√£o claro que permita prever o teor alco√≥lico a partir da acidez vol√°til.

### 5. Balanceamento de Classes
O dataset apresenta alto desbalanceamento nas classes de qualidade, o que poderia enviesar os modelos.

Foi aplicada a t√©cnica **SMOTEENN**, que combina:
- **SMOTE:** gera amostras sint√©ticas para a classe minorit√°ria
- **Undersampling inteligente:** remove ru√≠dos e pontos conflitantes entre classes

Com isso, as fronteiras entre as classes ficaram mais limpas, aumentando a robustez do treinamento.

### 6. Conclus√µes e Pr√≥ximos Passos
- A correla√ß√£o entre teor alco√≥lico e qualidade √© moderada, mas n√£o implica causalidade
- O pr√©-processamento incluiu capping para outliers e padroniza√ß√£o para vari√°veis de alta variabilidade
- O desbalanceamento foi corrigido com SMOTEENN, reduzindo vi√©s nos modelos
- A pr√≥xima etapa ser√° o treinamento de algoritmos de classifica√ß√£o usando as vari√°veis originais
- Caso o desempenho n√£o atinja o esperado, ser√£o incorporadas vari√°veis externas (tipo de uva, regi√£o clim√°tica, t√©cnicas de vinifica√ß√£o) para aprimorar a previs√£o da qualidade

## ü§ñ Machine Learning

Nesta etapa, aplicamos diferentes algoritmos de machine learning para prever a qualidade do vinho com base nas vari√°veis do nosso dataset.

O objetivo foi comparar modelos, avaliar m√©tricas de desempenho e realizar valida√ß√µes para garantir que as previs√µes sejam consistentes e livres de overfitting, assegurando a melhor escolha para uso em produ√ß√£o.

### üîπ Modelos utilizados

#### Classifica√ß√£o
- `logistic_regression` ‚Üí log_reg
- `random_forest` ‚Üí rf_clf
- `xgboost` ‚Üí xgb_clf
- `lightgbm` ‚Üí lgbm_clf
- `catboost` ‚Üí catb_clf
- `tree_classifier` ‚Üí treec_clf
- `svm_classifier` ‚Üí svm_clf

#### Regress√£o
- `linear_regression` ‚Üí lin_reg
- `random_forest` ‚Üí rf_reg
- `xgboost` ‚Üí xgb_reg
- `lightgbm` ‚Üí lgbm_reg

#### Clustering
- `kmeans` ‚Üí kmeans_cluster
- `dbscan` ‚Üí dbscan_cluster

Nosso modelo base, a **√Årvore de Classifica√ß√£o**, j√° apresentou um resultado muito satisfat√≥rio, como mostrado anteriormente. A partir dele, rodamos outros modelos para compara√ß√£o e aplicamos valida√ß√µes para garantir que nossos dados n√£o estivessem sofrendo de overfitting, o que poderia prejudicar as previs√µes.

### üìä Compara√ß√£o de Modelos
- **Regress√£o Log√≠stica** ‚Üí Teve desempenho inferior ao modelo base
- **Todos os modelos** ‚Üí Obtiveram F1-score acima de 80%, um √≥timo resultado para nossas predi√ß√µes
- **Melhor desempenho** ‚Üí Random Forest, com 97% de F1-score ‚Äî modelo escolhido para as valida√ß√µes finais

### üîç Valida√ß√µes Realizadas

#### 1. Valida√ß√£o Cruzada + Random Search
Foi aplicada valida√ß√£o cruzada combinada com Random Search, que testa diferentes blocos de dados separadamente, preservando a generaliza√ß√£o.

**Resultados:**
- M√©dia dos scores por fold: 0.96
- Desvio padr√£o: 0.0053 (baixo, indicando consist√™ncia)
- Resultado id√™ntico de acur√°cia (0.955) foi obtido mesmo sem cruzar os dados, refor√ßando a estabilidade do modelo

#### 2. An√°lise de Overfitting
- Apesar de o treino apresentar score 1.0, o teste manteve 0.955, mostrando que o modelo est√° generalizando bem para dados novos
- A curva de aprendizado confirmou que a valida√ß√£o est√° pr√≥xima ao treino, sem evid√™ncias de overfitting

### ‚úÖ Conclus√£o
Os testes e valida√ß√µes confirmaram que o **Random Forest** √© o modelo mais adequado para este problema, entregando alta performance e mantendo a capacidade de generaliza√ß√£o. O pr√≥ximo passo ser√° aplicar este modelo em dados novos para validar seu comportamento em produ√ß√£o.

## üöÄ Como utilizar no projeto

A arquitetura do projeto foi pensada para ser pr√°tica. Para treinar, avaliar e fazer previs√µes com qualquer modelo dispon√≠vel, siga o guia abaixo.

### 1. Instala√ß√£o e Configura√ß√£o
Para replicar o ambiente de desenvolvimento, siga estes passos:

**Crie e ative o ambiente virtual:**
```bash
# Criar um novo ambiente
# Conda
conda create --name <nome_do_seu_projeto> python=3.10

# Ativar o ambiente
# Conda
conda activate <nome_do_seu_projeto>
# Git Bash (ou WSL/Linux)
source .venv/Scripts/activate
# PowerShell 
.venv\Scripts\Activate.ps1
# Prompt de Comando (cmd) 
.venv\Scripts\activate.bat
```

**Instale as depend√™ncias caso n√£o esteja utilizando o poetry:**
```bash
pip install -r requirements.txt
```
```bash
conda env create -f environment.yml
```

**Com o poetry**
```bash
poetry install
```

**Configure no VS Code:**
1. Pressione `Ctrl + Shift + P`
2. Digite "Python: Select Interpreter"
3. Escolha o ambiente que voc√™ criou

### 2. Exemplo de uso com o pipeline_classification
A forma mais pr√°tica de testar um modelo √© utilizando a fun√ß√£o de pipeline. Basta fornecer o caminho do seu arquivo de dados e o nome do modelo desejado.

```python
from src.models.pipeline_classification import pipeline_classification

# Exemplo de uso para o modelo RandomForest
results = pipeline_classification(
    data_path=DATA_PROCESSED / 'seu_dataset_processado.csv',
    target_column='qualidade',
    model_name='random_forest',
    scale_type='standard',
    test_size=0.2
)

# Para inspecionar os resultados
print("M√©tricas de Avalia√ß√£o:", results['metrics'])
print("Modelo Treinado:", results['model'])
```

### 3. Testes individuais
Para testar um modelo espec√≠fico sem usar o pipeline completo, voc√™ pode criar e treinar diretamente:

```python
from src.models.model_factory import ModelFactory

# Carregar o modelo desejado
modelo = ModelFactory.create_classification_model("random_forest")

# Treinar e usar o modelo
modelo.fit(X_train, y_train)
predicoes = modelo.predict(X_test)
```

## üìö Refer√™ncias

- **UCI Machine Learning Repository** - Wine Quality Dataset

- **Winefun** - "Acidez vol√°til: conhe√ßa um dos defeitos mais controvertidos do mundo dos vinhos"  
  Fonte: Winefun  
  https://winefun.com.br/acidez-volatil-conheca-um-dos-defeitos-mais-controvertidos-do-mundo-dos-vinhos/

- **Wine.com.br** - Winepedia: "√Ålcool pra qu√™?"  
  https://www.wine.com.br/winepedia/alcool-pra-que/

---

*Este projeto faz parte do meu portf√≥lio em desenvolvimento durante a p√≥s-gradua√ß√£o em Data Analytics. √Ä medida que avan√ßo no curso, novas t√©cnicas e an√°lises ser√£o incorporadas para enriquecer este e outros estudos.*